<!DOCTYPE html>
<html>
	<head>
		<title>Converter</title>
		<meta charset='utf-8'/>
		<link rel='stylesheet' href='css/vendor/skeleton.css'/>
		<link rel='stylesheet' href='css/vendor/font-awesome.min.css' />
		<link rel='stylesheet' href='css/style.css?v=0' />
	</head>
	<body>
		<div id="container">

		</div>

		<script type="text/javascript" src="js/vendor/jszip.js"></script>
		<script type="text/javascript" src="js/vendor/cpexcel.js"></script>
		<script type="text/javascript" src="js/vendor/xlsx.js"></script>
		<script type="text/javascript" src="js/vendor/ractive-0.7.3.min.js"></script>
		<script type="text/javascript" src="js/vendor/underscore-1.8.3.min.js"></script>
		<script type="text/javascript" src="js/vendor/xml2json.min.js"></script>

		<script type="text/html" id="template-main">
			<div id="top-bar">
				<div class="row" id="file-input-container">
					<div class="six columns">
						<form id="file-input-form">
							<input class="u-full-width" type='file' on-change="chooseFile" />
							{{#processing}}
								<i class="fa fa-circle-o-notch fa-spin loading"></i>
							{{/processing}}
						</form>
					</div>
					<div class="six columns">
							Status: {{statusMessage}}
					</div>
				</div>

				<div class="row" id="sheets-nav">
					{{#sheets:i}}
						<button class="button{{#isVisible}}-primary{{/isVisible}}" on-click="switchSheet:{{i}}">{{name}}</button>
					{{/sheets}}
				</div>
			</div>

			<div id="sheets-container">
				{{#sheets:id}}
					{{#isVisible}}
						{{>sheet}}
					{{/isVisible}}
				{{/sheets}}
			</div>
		</script>

		<script id="sheet" type="text/html">
			<div class="sheet" id="sheet-{{id}}">
				<div class="row">
					<div class="six columns settings-form-container">
					{{#isVisible}}
						<button class="{{#showSettingsForm}}button-primary{{/showSettingsForm}}" on-click="toggleSettingsForm">Conversion settings</button>
						{{#showSettingsForm}}
							{{>settings-form}}
						{{/showSettingsForm}}
					{{/isVisible}}
					</div>
				</div>
				<div class="row data-table-container">
					<button on-click="scrollToElement:{{'sheet-' + id + '-xml'}}">Go to XML</button>
					{{>data-table}}
				</div>

				<div class="row data-xml-container">
					{{>xml}}
				</div>

			</div>
		</script>

		<script id="settings-form" type="text/html">
			<form class="settings-form">
				<label>Root node name</label>
				<input type="text" class="u-full-width" value="{{rootTag}}"/>
				<label>
			    <input type="checkbox" checked="{{useCommonRowTag}}">
			    <span class="label-body">Use common row node name</span>
			  </label>
			  {{#useCommonRowTag}}
					<input type="text" class="u-full-width" value="{{commonRowTag}}"/>
				{{/useCommonRowTag}}
				<label>
			    <input type="checkbox" checked="{{useCommonColTag}}">
			    <span class="label-body">Use common column node name</span>
			  </label>
			  {{#useCommonColTag}}
					<input type="text" class="u-full-width" value="{{commonColTag}}"/>
				{{/useCommonColTag}}
				<label>
			    <input type="checkbox" checked="{{useSelfClosingTags}}">
			    <span class="label-body">Use self-closing tags</span>
		  	</label>
				<label>Tab Size</label>
				<input type="text" class="u-full-width" value="{{tabLength}}"/>
			</form>
		</script>

		<script type="text/html" id="data-table">
			<table class="data-table" id="sheet-{{id}}-data-table">
				<tr>
					<th></th>
					{{#colTags}}
						<th>
							{{#useCommonColTag}}
								{{commonColTag}}
							{{/useCommonColTag}}
							{{^useCommonColTag}}
								<input type="text" value="{{this}}"  class="col-node-name" />
							{{/useCommonColTag}}
						</th>
					{{/colTags}}
					<th></th>
				</tr>
				{{#rows:r}}
					<tr class="{{deleted ? 'deleted' : ''}}">
						<th>
							{{#if !deleted}}
								{{#useCommonRowTag}}
									{{commonRowTag}}
								{{/useCommonRowTag}}
								{{^useCommonRowTag}}
									<input type="text" class="row-node-name" value="{{this.tag}}" />
								{{/useCommonRowTag}}
							{{/if}}
						</th>

						{{#children:i}}
							<td>{{.content}}</td>
						{{/children}}
						<td class="actions">
							<a class="button button-primary button-icon" on-click="useRowForColNodeNames: {{.}}" title="Use this row as column headers">
								<i class="fa fa-fw fa-table fa-2x"></i>
							</a>
							{{#if deleted}}
								<a class="button button-primary button-icon" on-click="unDeleteRow: {{.}}" title="Delete this row">
									<i class="fa fa-fw fa-undo fa-2x"></i>
								</a>
							{{else}}
								<a class="button button-primary button-icon" on-click="deleteRow: {{.}}" title="Restore this row">
									<i class="fa fa-fw fa-trash fa-2x"></i>
								</a>
							{{/if}}
						</td>
					</tr>
				{{/rows}}
			</table>
		</script>

		<script type="text/html" id="xml">
			<div class="xml-container" id="sheet-{{id}}-xml">
				<button on-click="scrollToElement:{{'sheet-' + id + '-data-table'}}">Go to top of data table</button>

				<pre><code>
					{{#if rows}}
						{{outputXML(.)}}
					{{/if}}
				</code></pre>
			</div>
		</script>

		<script type="text/javascript" src="js/script.js"></script>
</html>

